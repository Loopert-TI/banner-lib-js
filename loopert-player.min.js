function loadScript(e,t={}){return new Promise(((n,r)=>{if(document.querySelector(`script[src="${e}"]`))return void n();const i=document.createElement("script");i.src=e,Object.keys(t).forEach((e=>{i.setAttribute(e,t[e])})),i.onload=()=>n(),i.onerror=()=>r(new Error(`Falha ao carregar ${e}`)),document.head.appendChild(i)}))}function extractDataAttributes(e){const t={};return Object.entries(e.dataset).forEach((([e,n])=>{const r=`data-${e.replace(/([A-Z])/g,"-$1").toLowerCase()}`;t[r]=n})),t}function findLoopertScripts(){return Array.from(document.querySelectorAll('script[src*="loopert-player"]'))}class LoopertPlayer{constructor(e={}){this.options={id:"player",streamUrl:"",backgroundImage:"",backgroundColor:"#2E5EAA",borderColor:"#2E5EAA",...e},this.player=null,this.bannerInitialized=!1,this.init()}createPlayerDiv(){let e=document.getElementById(this.options.id);e||(e=document.createElement("div"),e.id=this.options.id,document.body.appendChild(e))}async init(){try{this.createPlayerDiv(),await this.loadDependencies(),this.initPlayer()}catch(e){console.error("Erro ao inicializar LoopertPlayer:",e)}}async loadDependencies(){const e=[];if(window.Playerjs||e.push(loadScript("https://cdn.jsdelivr.net/gh/Loopert-TI/banner-lib-js@latest/player.min.js")),!window.BannerLib){const t=findLoopertScripts();if(0===t.length)return;const n=extractDataAttributes(t[0]);e.push(loadScript("https://cdn.jsdelivr.net/gh/Loopert-TI/banner-lib-js@latest/banner-lib.min.js",n))}await Promise.all(e)}initPlayer(){if(!window.Playerjs)throw new Error("Playerjs não está disponível");window.PlayerjsEvents=(e,t,n)=>{this.handlePlayerEvents(e,t,n)},this.player=new window.Playerjs({id:this.options.id,file:this.options.streamUrl,poster:this.options.backgroundImage,...this.getPlayerJsOptions()});const e=document.getElementById("player");document.getElementById("oframeplayer").style.backgroundColor=this.options.backgroundColor,e.style.borderColor=this.options.borderColor}getPlayerJsOptions(){const e={...this.options};return delete e.streamUrl,e}handlePlayerEvents(e,t,n){switch(e){case"play":this.onPlay(t,n);break;case"pause":this.onPause(t,n);break;case"ended":this.onEnded(t,n);break;default:this.onGenericEvent(e,t,n)}this.options.onEvent&&"function"==typeof this.options.onEvent&&this.options.onEvent(e,t,n)}onPlay(e,t){this.bannerInitialized||this.initBanner()}onPause(e,t){}onEnded(e,t){}onGenericEvent(e,t,n){}initBanner(){if(window.BannerLib&&!this.bannerInitialized)try{window.BannerLib.init(),this.bannerInitialized=!0}catch(e){console.error("Erro ao inicializar banner:",e)}}play(){this.player&&this.player.api&&this.player.api("play")}pause(){this.player&&this.player.api&&this.player.api("pause")}stop(){this.player&&this.player.api&&this.player.api("stop")}setVolume(e){this.player&&this.player.api&&this.player.api("volume",e)}setFile(e){this.player&&this.player.api&&this.player.api("file",e)}destroy(){this.player&&this.player.api&&this.player.api("destroy"),this.player=null,this.bannerInitialized=!1}getPlayer(){return this.player}}!function(){"use strict";function e(){console.log("audio playing..."),console.trace(),window.BannerLib.init()}async function t(){try{await async function(){const e=findLoopertScripts();if(0===e.length)return;const t=[];if(!window.BannerLib){const n=extractDataAttributes(e[0]);t.push(loadScript("https://cdn.jsdelivr.net/gh/Loopert-TI/banner-lib-js@latest/banner-lib.min.js",n))}try{await Promise.all(t)}catch(e){throw console.error("Erro ao carregar dependências:",e),e}}(),function(){const t=findLoopertScripts();if(0===t.length)return;const n=t[0].dataset.playerId;if(!n)return;const r=document.getElementById(n);r&&(r.dataset.listenerAdded||(r.addEventListener("play",e),r.dataset.listenerAdded="true"))}(),document.dispatchEvent(new CustomEvent("loopertPlayerReady",{detail:{timestamp:Date.now()}}))}catch(e){document.dispatchEvent(new CustomEvent("loopertPlayerError",{detail:{error:e.message,timestamp:Date.now()}}))}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t):t()}();