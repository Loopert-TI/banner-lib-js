function loadScript(t,e={}){return new Promise(((r,n)=>{if(document.querySelector(`script[src="${t}"]`))return void r();const i=document.createElement("script");i.src=t,Object.keys(e).forEach((t=>{i.setAttribute(t,e[t])})),i.onload=()=>r(),i.onerror=()=>n(new Error(`Falha ao carregar ${t}`)),document.head.appendChild(i)}))}function extractDataAttributes(t){const e={};return Object.entries(t.dataset).forEach((([t,r])=>{const n=`data-${t.replace(/([A-Z])/g,"-$1").toLowerCase()}`;e[n]=r})),e}function findLoopertScripts(){return Array.from(document.querySelectorAll('script[src*="loopert-player"]'))}class LoopertPlayer{constructor(t={}){this.options={id:"player",streamUrl:"",backgroundImage:"",backgroundColor:"#2E5EAA",borderColor:"#2E5EAA",...t},this.player=null,this.bannerInitialized=!1,this.init()}createPlayerDiv(){let t=document.getElementById(this.options.id);t||(t=document.createElement("div"),t.id=this.options.id,document.body.appendChild(t))}async init(){try{this.createPlayerDiv(),await this.loadDependencies(),this.initPlayer()}catch(t){console.error("Erro ao inicializar LoopertPlayer:",t)}}async loadDependencies(){const t=[];if(window.Playerjs||t.push(loadScript("https://cdn.jsdelivr.net/gh/Loopert-TI/banner-lib-js@latest/player.min.js")),!window.BannerLib){const e=findLoopertScripts();if(0===e.length)return;const r=extractDataAttributes(e[0]);t.push(loadScript("https://cdn.jsdelivr.net/gh/Loopert-TI/banner-lib-js@latest/banner-lib.min.js",r))}await Promise.all(t)}initPlayer(){if(!window.Playerjs)throw new Error("Playerjs não está disponível");window.PlayerjsEvents=(t,e,r)=>{this.handlePlayerEvents(t,e,r)},this.player=new window.Playerjs({id:this.options.id,file:this.options.streamUrl,poster:this.options.backgroundImage,...this.getPlayerJsOptions()});const t=document.getElementById("player");document.getElementById("oframeplayer").style.backgroundColor=this.options.backgroundColor,t.style.borderColor=this.options.borderColor}getPlayerJsOptions(){const t={...this.options};return delete t.streamUrl,t}handlePlayerEvents(t,e,r){switch(t){case"play":this.onPlay(e,r);break;case"pause":this.onPause(e,r);break;case"ended":this.onEnded(e,r);break;default:this.onGenericEvent(t,e,r)}this.options.onEvent&&"function"==typeof this.options.onEvent&&this.options.onEvent(t,e,r)}onPlay(t,e){this.bannerInitialized||this.initBanner()}onPause(t,e){}onEnded(t,e){}onGenericEvent(t,e,r){}initBanner(){if(window.BannerLib&&!this.bannerInitialized)try{window.BannerLib.init(),this.bannerInitialized=!0}catch(t){console.error("Erro ao inicializar banner:",t)}}play(){this.player&&this.player.api&&this.player.api("play")}pause(){this.player&&this.player.api&&this.player.api("pause")}stop(){this.player&&this.player.api&&this.player.api("stop")}setVolume(t){this.player&&this.player.api&&this.player.api("volume",t)}setFile(t){this.player&&this.player.api&&this.player.api("file",t)}destroy(){this.player&&this.player.api&&this.player.api("destroy"),this.player=null,this.bannerInitialized=!1}getPlayer(){return this.player}}!function(){"use strict";function t(){window.BannerLib.init()}!async function(){try{await async function(){const t=findLoopertScripts();if(0===t.length)return;const e=[];if(!window.BannerLib){const r=extractDataAttributes(t[0]);e.push(loadScript("https://cdn.jsdelivr.net/gh/Loopert-TI/banner-lib-js@latest/banner-lib.min.js",r))}try{await Promise.all(e)}catch(t){throw console.error("Erro ao carregar dependências:",t),t}}(),function(){const e=findLoopertScripts();if(0===e.length)return;const r=e[0].dataset.playerId;if(!r)return;const n=document.getElementById(r);n&&n.addEventListener("play",t)}(),document.dispatchEvent(new CustomEvent("loopertPlayerReady",{detail:{timestamp:Date.now()}}))}catch(t){document.dispatchEvent(new CustomEvent("loopertPlayerError",{detail:{error:t.message,timestamp:Date.now()}}))}}()}();